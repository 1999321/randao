// geth --dev --mine --genesis genesis_block.json --datadir ./data  console 2>> out.log.geth

console.log("unlocking")
personal.unlockAccount(web3.eth.accounts[0], "Write here a good, randomly generated, passphrase!")
personal.unlockAccount(web3.eth.accounts[1], "Write here a good, randomly generated, passphrase!")

console.log("deploy new campaign");
var mined = 0;
var _defaultServiceProvider = web3.eth.accounts[0]/* var of type address here */ ;
var _daoCreator = web3.eth.accounts[1]/* var of type address here */ ;
var randaoContract = web3.eth.contract([{ "constant": false, "inputs": [{ "name": "_bnum", "type": "uint32" }, { "name": "_deposit", "type": "uint96" }, { "name": "_commitDeadline", "type": "uint8" }, { "name": "_commitBalkline", "type": "uint8" }], "name": "newCampaign", "outputs": [{ "name": "_campaignID", "type": "uint256" }], "type": "function" }, { "constant": true, "inputs": [{ "name": "", "type": "uint256" }], "name": "campaigns", "outputs": [{ "name": "bnum", "type": "uint32" }, { "name": "deposit", "type": "uint96" }, { "name": "commitDeadline", "type": "uint8" }, { "name": "commitBalkline", "type": "uint8" }, { "name": "reveals", "type": "uint16" }, { "name": "random", "type": "uint256" }, { "name": "settled", "type": "bool" }, { "name": "bountypot", "type": "uint96" }], "type": "function" }, { "constant": false, "inputs": [{ "name": "_campaignID", "type": "uint256" }], "name": "checkSettled", "outputs": [{ "name": "settled", "type": "bool" }], "type": "function" }, { "constant": true, "inputs": [], "name": "numCampaigns", "outputs": [{ "name": "", "type": "uint256" }], "type": "function" }, { "constant": true, "inputs": [], "name": "version", "outputs": [{ "name": "", "type": "uint8" }], "type": "function" }, { "constant": true, "inputs": [], "name": "callbackFee", "outputs": [{ "name": "", "type": "uint96" }], "type": "function" }, { "constant": false, "inputs": [{ "name": "_campaignID", "type": "uint256" }, { "name": "_s", "type": "uint256" }], "name": "reveal", "outputs": [], "type": "function" }, { "constant": false, "inputs": [{ "name": "_campaignID", "type": "uint256" }], "name": "getRandom", "outputs": [{ "name": "", "type": "uint256" }], "type": "function" }, { "constant": false, "inputs": [{ "name": "_str", "type": "bytes" }, { "name": "_index", "type": "uint256" }, { "name": "_size", "type": "uint256" }], "name": "slice", "outputs": [{ "name": "", "type": "bytes" }], "type": "function" }, { "constant": false, "inputs": [{ "name": "_campaignID", "type": "uint256" }, { "name": "_hs", "type": "bytes32" }], "name": "commit", "outputs": [], "type": "function" }, { "inputs": [], "type": "constructor" }, { "anonymous": false, "inputs": [{ "indexed": false, "name": "campaignID", "type": "uint256" }, { "indexed": false, "name": "bnum", "type": "uint32" }, { "indexed": false, "name": "deposit", "type": "uint96" }, { "indexed": false, "name": "commitDeadline", "type": "uint8" }, { "indexed": false, "name": "commitBalkline", "type": "uint8" }], "name": "CampaignAdded", "type": "event" }]);

var deposit = web3.toWei('2', 'ether');
var target_block = web3.eth.blockNumber + 10;

console.log('blockNumber: ', web3.eth.blockNumber);
console.log('target_block: ', target_block);

var randao = randaoContract.new(
   _defaultServiceProvider,
   _daoCreator,
   {
     from: web3.eth.accounts[0],
     data: '6060604052600280546001606060020a03191667016345785d8a0000179055610bb28061002c6000396000f3606060405236156100825760e060020a60003504630db472cf8114610084578063141961bc146101895780631e193b69146101fa5780632c0f7b6f146102c957806354fd4d50146102d257806391ff7865146102da5780639348cef7146102ec578063cd4b69141461032a578063e00413961461039d578063f2f0387714610427575b005b6104e1600435602435604435606435600080546001818101835581835260209081526040928390208054608860020a860271ff000000000000000000000000000000000019608060020a890270ff00000000000000000000000000000000196401000000008c026fffffffffffffffffffffffff000000001963ffffffff199096168e179590951694909417939093169290921791909116178155835183815263ffffffff8916928101929092526001606060020a0387168285015260ff86811660608401528516608083015292519192917f7bae521b658ca9d8a2e5d18ae0fc9529b3b67a05e13a8c958411a9979fe2d2d79181900360a00190a150949350505050565b6104f360043560016020819052600091825260409091209081015481546002929092015463ffffffff83169264010000000081046001606060020a0390811693608060020a830460ff90811694608860020a8504821694609060020a900461ffff1693918116916101009091041688565b6104e16004356000818152600160205260408120805463ffffffff16431061077657600281015460ff16151561077657610776815b60028101805460ff1916600117905580546000609060020a90910461ffff16111561095a5780546004820154609060020a90910461ffff161415610857576108578160005b6004820154811015610b2a5760048201805460058401916000918490811015610002575081526020808220840154600160a060020a031682529190915260409020546001838101805490921890915501610274565b6104e160005481565b61054c600181565b6105636002546001606060020a031681565b61008260043560243560008281526001602052604081208054909190819064010000000090046001606060020a031634101561069e573491506106b6565b6104e1600435600080805260016020527fa6eef7e35abe7026729641147f7915573c7e97b47efa546f5f6e3230263bcb49805463ffffffff164310610787577fa6eef7e35abe7026729641147f7915573c7e97b47efa546f5f6e3230263bcb4b5460ff1615156107ef576107ef8161022f565b6040805160206004803580820135601f81018490048402850184019095528484526105809491936024939092918401919081908401838280828437509496505093359350506044359150505b60408051602081810183526000808352835191820190935282815290919081848114806104195750865185870110155b15610804578651925061080a565b61008260043560243560008281526001602052604090208054608860020a810460ff1663ffffffff9182160316431080159061047757508054608060020a810460ff1663ffffffff918216031643105b156105ee57816000141580156104a85750600160a060020a0333166000908152600582016020526040812060010154145b156105fe576004810180546001810180835533929190829082801582901161060757600083815260209020610607918101908301610686565b60408051918252519081900360200190f35b6040805163ffffffff9990991689526001606060020a0397881660208a015260ff9687168982015294909516606088015261ffff909216608087015260a086015260c0850152911660e083015251908190036101000190f35b6040805160ff929092168252519081900360200190f35b604080516001606060020a03929092168252519081900360200190f35b60405180806020018281038252838181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156105e05780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b610667345b610ae35b60643a0290565b610667346105f3565b505050815481101561000257600091825260208083209091018054600160a060020a03191690931790925560408051808201825282815280840186815233600160a060020a03168452600586019094529120905181559051600191909101555b505050565b601f016020900490600052602060002090810190610a1f91905b8082111561069a5760008155600101610686565b5090565b825464010000000090046001606060020a0316340391505b825463ffffffff16431080156106e157508254608060020a810460ff1663ffffffff91821603164310155b156107665750600160a060020a0333166000908152600583016020908152604080519281902060018101548785529151938490039092019092209091141561076657838160000160005054141515610762578254609060020a80820461ffff166001010273ffff000000000000000000000000000000000000199091161783555b8381555b61076f826105f3565b5050505050565b600281015460ff1691505b50919050565b6002546001606060020a031634106107fb576107ef8160406040519081016040528033815260200161095d6000368080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050609460046103e9565b60018101549150610781565b6107ef346105f3565b85850192505b50845b8281101561084d57868181518110156100025790602001015160f860020a900460f860020a0282878303815181101561000257016020015260010161080d565b5095945050505050565b600181015460009011156108f3576108f3816000805b600383015482101561066757600383018054839081101561000257906000526020600020906002020160005080546001858101546040518483018054959650600160a060020a0394909416949192909182918591600291811615610100026000190116048015610b855780601f10610b5a57610100808354040283529160200191610b85565b61095a818054600282015460643a029161ffff609060020a909104166101009091046001606060020a03160460005b6004840154811015610b2e576004840180548290811015610002576000918252602082200154600160a060020a031690610b346105f7565b50565b9052600382018054600181018083558290828015829011610997576002028160020283600052602060002091820191016109979190610a25565b5050508154811015610002576000918252602080832060029283020180548551600160a060020a0319919091161781558482015180516001838101805481895297869020949790969181161561010002600019011604601f90810185900484019491939290910190839010610a6957805160ff19168380011785555b50610a99929150610686565b50506001015b8082111561069a578054600160a060020a031916815560018181018054600080835592600290821615610100026000190190911604601f81901061066c5750610a1f565b82800160010185558215610a13579182015b82811115610a13578251826000505591602001919060010190610a7b565b5050905050610aa66105f7565b6002820180546101008082046001606060020a0390811694163403939093019092026cffffffffffffffffffffffff001990921691909117905550565b6001606060020a031681111561095a5733600160a060020a03166000610b076105f7565b6040516001606060020a03919091168403906000818181858888f1505050505050565b5050565b50505050565b6040519085036001606060020a0316906000818181858888f15050505050600101610922565b820191906000526020600020905b815481529060010190602001808311610b6857829003601f168201915b5050828152602001925050506000604051808303816000866161da5a03f15050506001919091019061086d56',
     gas: 3000000,
     gasPrice: 500000000000
   }, function(e, contract){
    console.log(e, contract);
    if (typeof contract.address != 'undefined') {
         console.log('Contract mined! address: ' + contract.address + ' transactionHash: ' + contract.transactionHash);
         mined = 1
    }
 })

console.log("mining contract plz wait")
miner.start(1); admin.sleepBlocks(1); miner.stop();
